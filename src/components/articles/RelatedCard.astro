---
import { getCollection } from "astro:content";
const { heading, slug } = Astro.props;

const articles = await getCollection("articles");
const article = articles.find((a) => a.slug === slug);
if (!article) throw new Error(`記事が見つかりません: ${slug}`);

const { title, intro, introImage } = article.data;
const thumbPath = introImage ?? `/images/intro/${slug}.jpg`;
---

<div class="related-card-container">
  <div class="related-card-label text-white text-sm font-semibold px-4 py-2" style="background-color: #82A0AA;">
    {heading}
  </div>
  <a href={`/articles/${slug}/`} class="related-card flex gap-4 items-start no-underline p-4 border border-[#EEE8E6] rounded-md">
    <div class="w-[110px] sm:w-[140px] aspect-[4/3] overflow-hidden rounded-md flex-shrink-0">
      <img
        src={thumbPath}
        alt={`${title} のサムネイル`}
        class="w-full h-full object-cover block"
        loading="lazy"
        decoding="async"
      />
    </div>
    <div class="flex flex-col justify-start w-full">
      <h2 class="text-base sm:text-lg font-bold text-[#6a6a6a] mb-2 break-jp break-words line-clamp-2">
        {title}
      </h2>
      {intro && (
        <p class="text-xs sm:text-sm text-[#888888] leading-snug line-clamp-3">
          {intro}
        </p>
      )}
    </div>
  </a>
</div>
